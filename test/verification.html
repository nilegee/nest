<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Console Error Fix Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-results {
            margin-top: 20px;
        }
        .pass { color: green; }
        .fail { color: red; }
        .console-monitor {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        .summary {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>üõ†Ô∏è Console Error Fix Verification</h1>
    <p>This test verifies that our 403 error handling improvements work correctly and prevent console spam.</p>
    
    <div class="test-results" id="results">
        <p>Running tests...</p>
    </div>
    
    <h2>Console Monitor</h2>
    <div class="console-monitor" id="console-monitor">
        <p>Monitoring console for errors...</p>
    </div>
    
    <script type="module">
        // Mock console to capture any errors
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;
        const consoleMessages = [];
        
        console.error = function(...args) {
            consoleMessages.push({type: 'error', message: args.join(' ')});
            updateConsoleMonitor();
            originalConsoleError.apply(console, args);
        };
        
        console.warn = function(...args) {
            consoleMessages.push({type: 'warn', message: args.join(' ')});
            updateConsoleMonitor();
            originalConsoleWarn.apply(console, args);
        };
        
        function updateConsoleMonitor() {
            const monitor = document.getElementById('console-monitor');
            if (consoleMessages.length === 0) {
                monitor.innerHTML = '<p style="color: green;">‚úÖ No console errors or warnings detected!</p>';
            } else {
                monitor.innerHTML = consoleMessages.map(msg => 
                    `<div style="color: ${msg.type === 'error' ? 'red' : 'orange'};">[${msg.type.toUpperCase()}] ${msg.message}</div>`
                ).join('');
            }
        }
        
        // Import and run our verification tests
        import('./console-error-verification.js').then(module => {
            return module.runConsoleErrorVerification();
        }).then(results => {
            const resultsDiv = document.getElementById('results');
            let html = '<h2>Test Results</h2>';
            
            results.results.forEach(test => {
                const status = test.status === 'PASS' ? '‚úÖ PASS' : '‚ùå FAIL';
                const className = test.status === 'PASS' ? 'pass' : 'fail';
                html += `<div class="${className}"><strong>${status}</strong> - ${test.name}: ${test.message}</div>`;
            });
            
            html += `<div class="summary">
                <h3>Summary</h3>
                <p><strong>Tests Passed:</strong> ${results.passed}/${results.total}</p>
                <p><strong>Console Errors/Warnings:</strong> ${consoleMessages.length}</p>
                <p><strong>Overall Status:</strong> ${results.passed === results.total && consoleMessages.length === 0 ? '‚úÖ ALL GOOD' : '‚ùå ISSUES FOUND'}</p>
            </div>`;
            
            resultsDiv.innerHTML = html;
        }).catch(error => {
            document.getElementById('results').innerHTML = `<div class="fail">‚ùå Test failed: ${error.message}</div>`;
        });
        
        // Initialize console monitor
        updateConsoleMonitor();
    </script>
</body>
</html>